// Generated by CoffeeScript 1.12.6
(function() {
  var YAML, async, errors, isArray, isObject, read, ref;

  ref = require("fairmont"), async = ref.async, read = ref.read, isObject = ref.isObject, isArray = ref.isArray;

  YAML = require("js-yaml");

  errors = require("./errors");

  module.exports = {
    read: async(function*(_path, schema) {
      var data, error, path, yaml, yamlSchema;
      path = _path === "-" ? process.stdin : _path;
      yamlSchema = YAML.DEFAULT_SAFE_SCHEMA;
      if (schema === "failsafe") {
        yamlSchema = YAML.FAILSAFE_SCHEMA;
      }
      try {
        yaml = (yield read(path));
      } catch (error1) {
        error = error1;
        errors.readingPath(error, path);
      }
      try {
        data = YAML.safeLoad(yaml, {
          schema: yamlSchema
        });
      } catch (error1) {
        error = error1;
        errors.parsingYAML(error);
      }
      return data;
    }),
    write: function(data) {
      var error, result;
      result = (function() {
        if (data != null) {
          if (isObject(data)) {
            try {
              return YAML.safeDump(data).slice(0, -1);
            } catch (error1) {
              error = error1;
              return errors.formatYAML(error);
            }
          } else if (isArray(data)) {
            return data.join("\n");
          } else {
            return data.toString();
          }
        } else {
          return "";
        }
      })();
      return console.log(result);
    }
  };

}).call(this);
